<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="
The function Power_Proj_Test_ufDA() computes the power of
of the two-sample projection-based test for functional response data
setting, when the group difference, the eigenfunctions of the covariance
of the data are specified at dense grid of time points, along with the
(estimated) covariance of the shrinkage scores."><title>Power of the Two-sample Projection-based test for functional data with known (or estimated)
eigencomponents. — Power_Proj_Test_ufDA • fPASS</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Power of the Two-sample Projection-based test for functional data with known (or estimated)
eigencomponents. — Power_Proj_Test_ufDA"><meta property="og:description" content="
The function Power_Proj_Test_ufDA() computes the power of
of the two-sample projection-based test for functional response data
setting, when the group difference, the eigenfunctions of the covariance
of the data are specified at dense grid of time points, along with the
(estimated) covariance of the shrinkage scores."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">fPASS</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/fPASS.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/SalilKoner/fPASS/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Power of the Two-sample Projection-based test for functional data with known (or estimated)
eigencomponents.</h1>
      <small class="dont-index">Source: <a href="https://github.com/SalilKoner/fPASS/blob/HEAD/R/Power_Proj_Test_ufDA.R" class="external-link"><code>R/Power_Proj_Test_ufDA.R</code></a></small>
      <div class="d-none name"><code>Power_Proj_Test_ufDA.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><a href="https://lifecycle.r-lib.org/articles/stages.html#experimental" class="external-link"><img src="figures/lifecycle-experimental.svg" alt="[Experimental]"></a></p>
<p>The function <code>Power_Proj_Test_ufDA()</code> computes the power of
of the two-sample projection-based test for functional response data
setting, when the group difference, the eigenfunctions of the covariance
of the data are specified at dense grid of time points, along with the
(estimated) covariance of the <code>shrinkage</code> scores.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">Power_Proj_Test_ufDA</span><span class="op">(</span></span>
<span>  <span class="va">total_sample_size</span>,</span>
<span>  <span class="va">argvals</span>,</span>
<span>  <span class="va">mean_vector</span>,</span>
<span>  <span class="va">eigen_matrix</span>,</span>
<span>  <span class="va">scores_var1</span>,</span>
<span>  <span class="va">scores_var2</span>,</span>
<span>  <span class="va">weights</span>,</span>
<span>  sig.level <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  alloc.ratio <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  npc_to_pick <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">eigen_matrix</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>total_sample_size</dt>
<dd><p>Total sample size combing the two groups, must be a positive integer.</p></dd>


<dt>argvals</dt>
<dd><p>The working grid of timepoints to evaluate the eigenfunctions and the mean functions.
It is preferred to take the working grid as dense grid so that
\(\int [\mu_1(t) - \mu_2(t)]\phi_k(t) \,dt\) can be calculated with a required precision.</p></dd>


<dt>mean_vector</dt>
<dd><p>The difference in the mean function evaluated at argvals, must be a numeric vector of length same
as that that of argavls.</p></dd>


<dt>eigen_matrix</dt>
<dd><p>The matrix of eigenfunctions evaluated at argvals,
must be a length(argvals) by K matrix, where K is the number of eigenfunctions.</p></dd>


<dt>scores_var1</dt>
<dd><p>The true (or estimate) of covariance matrix of the shrinkage scores for the first group.
Must be symmetric (<code>is.symmetric(scores_var1) == TRUE</code>) and positive definite
(<code>chol(scores_var1)</code> without an error!).</p></dd>


<dt>scores_var2</dt>
<dd><p>The true (or estimate) of covariance matrix of the shrinkage scores for the second group.
Must be symmetric (<code>is.symmetric(scores_var2) == TRUE</code>) and positive definite
(<code>chol(scores_var2)</code> without an error!).</p></dd>


<dt>weights</dt>
<dd><p>The weights to put to compute the projection \(\int [\mu_1(t) - \mu_2(t)]\phi_k(t) \,dt\),
for each \(k=1,\dots, K\). The integral is numerically approximated as
<code>sum(mean_diff(argvals)*eigen_matrix[,k]*weights)</code>.</p></dd>


<dt>sig.level</dt>
<dd><p>Significance level of the test, default set at 0.05, must be less than 0.2.
This is used to compute the critical value of the test.</p></dd>


<dt>alloc.ratio</dt>
<dd><p>Allocation of total sample size into the two groups. Must set as a vector of two
positive numbers. For equal allocation it should be put as c(1,1), for non-equal
allocation one can put c(2,1) or c(3,1) etc. Default set as c(1,1).</p></dd>


<dt>npc_to_pick</dt>
<dd><p>Number of eigenfunction to be used to compute the power. Typically this is
becomes handy when the user want to discard few of the last eigenfunctions,
typically with a very small eigenvalues.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>Power of the projection-based test for specified difference in the mean function
and the eigencomponents of the covariance of the functional data.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The projection-based test first extracts K eigenfunctions from the data, and then
project the mean difference function onto each of the eigenfunctions to obtain a K-dimensional
projection vector that reflects the group difference. Wang (2021) pointed that under the null
hypothesis the covariance of K-dimensional functional principal component analysis (fPCA) scores
are the same, and thus a Hotelling \(T^2\) test with assuming equal variance of the shrinkage scores
is a valid test. However, Koner and Luo (2023) pointed out that under the alternate hypothesis,
when the difference is mean is significant, the covariance of the shrinkage scores also differ
between the groups. Therefore, while computing the power of test, we must have to derive the
distribution of the Hotelling \(T^2\) statistic under the assumption of unequal variance. The
alogrithm for the power of multivariate Hotelling \(T^2\) under unequal variance
is coded in <code><a href="pHotellingT.html">pHotellingT()</a></code> function. This particular function is a wrapper around that
function, which inputs the mean difference as a function, and the eigenfunctions and
the scores, and subsequently call the <code><a href="pHotellingT.html">pHotellingT()</a></code> function to compute the power
under unequal variance. See Koner and Luo (2023) for more details on the
formula of the non-null distribution.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Wang, Qiyao (2021)
<em>Two-sample inference for sparse functional data,  Electronic Journal of Statistics,
Vol. 15, 1395-1423</em> <br><a href="https://doi.org/10.1214/21-EJS1802" class="external-link">doi:10.1214/21-EJS1802</a>
.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>See <code><a href="pHotellingT.html">pHotellingT()</a></code> and <code><a href="Sim_HotellingT_unequal_var.html">Sim_HotellingT_unequal_var()</a></code> for samples
from Hotelling T distribution.</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Salil Koner <br> Maintainer: Salil Koner
<a href="mailto:salil.koner@duke.edu">salil.koner@duke.edu</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">ngrid</span>          <span class="op">&lt;-</span> <span class="fl">101</span></span></span>
<span class="r-in"><span><span class="va">interval</span>       <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gauss.quad.pts</span> <span class="op">&lt;-</span> <span class="fu">gss</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gss/man/gauss.quad.html" class="external-link">gauss.quad</a></span><span class="op">(</span><span class="va">ngrid</span>,<span class="va">interval</span><span class="op">)</span> <span class="co"># evaluation points</span></span></span>
<span class="r-in"><span><span class="va">working.grid</span>   <span class="op">&lt;-</span> <span class="va">gauss.quad.pts</span><span class="op">$</span><span class="va">pt</span></span></span>
<span class="r-in"><span><span class="va">mean_fn</span>        <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span><span class="op">)</span> <span class="op">{</span><span class="fl">0.4</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="va">t</span><span class="op">)</span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="va">mean_vector</span>    <span class="op">&lt;-</span> <span class="fu">mean_fn</span><span class="op">(</span><span class="va">working.grid</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">eigen_fn</span>       <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span>, <span class="va">k</span><span class="op">)</span><span class="op">{</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="op">{</span><span class="op">(</span><span class="va">k</span><span class="op">==</span><span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="va">t</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="va">k</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="va">t</span><span class="op">)</span><span class="op">}</span> <span class="op">}</span></span></span>
<span class="r-in"><span><span class="va">eigen_matrix</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu">eigen_fn</span><span class="op">(</span><span class="va">working.grid</span>,<span class="fl">1</span><span class="op">)</span>, <span class="fu">eigen_fn</span><span class="op">(</span><span class="va">working.grid</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mean_proj</span>      <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="kw">function</span><span class="op">(</span><span class="va">r</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/integrate.html" class="external-link">integrate</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">eigen_fn</span><span class="op">(</span><span class="va">x</span>,<span class="va">r</span><span class="op">)</span><span class="op">*</span><span class="fu">mean_fn</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="va">interval</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">interval</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">$</span><span class="va">value</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sig1</span>           <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sig2</span>           <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">alp</span>            <span class="op">&lt;-</span> <span class="fl">0.05</span></span></span>
<span class="r-in"><span><span class="va">n</span>              <span class="op">&lt;-</span> <span class="fl">100</span></span></span>
<span class="r-in"><span><span class="va">k</span>              <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">eigen_matrix</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cutoff</span>         <span class="op">&lt;-</span> <span class="op">{</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="va">k</span><span class="op">/</span><span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="va">k</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">}</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/Fdist.html" class="external-link">qf</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">alp</span>, <span class="va">k</span>, <span class="va">n</span><span class="op">-</span><span class="va">k</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">func_power</span>     <span class="op">&lt;-</span> <span class="fu">Power_Proj_Test_ufDA</span><span class="op">(</span>total_sample_size<span class="op">=</span><span class="va">n</span>,</span></span>
<span class="r-in"><span>argvals<span class="op">=</span><span class="va">working.grid</span>,</span></span>
<span class="r-in"><span>mean_vector <span class="op">=</span> <span class="va">mean_vector</span>, eigen_matrix <span class="op">=</span> <span class="va">eigen_matrix</span>,</span></span>
<span class="r-in"><span>scores_var1 <span class="op">=</span> <span class="va">sig1</span>, scores_var2<span class="op">=</span> <span class="va">sig2</span>, weights <span class="op">=</span> <span class="va">gauss.quad.pts</span><span class="op">$</span><span class="va">wt</span>,</span></span>
<span class="r-in"><span>sig.level<span class="op">=</span><span class="va">alp</span>, alloc.ratio <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, npc_to_pick<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">eigen_matrix</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Salil Koner.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

